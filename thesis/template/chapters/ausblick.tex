\chapter{Zusammenfassung und Ausblick}
\label{chapter:ausblick}

Diese Kapitel fasst die Ergebnisse der Arbeit basierend auf den Teilergebnissen der vorigen Kapitel zusammen und liefert einen Ausblick über mögliche Folgethemen, die im Laufe dieser Arbeit herausgearbeitet wurden. 

\section{Zusammenfassung}

Dieser Abschnitt bietet eine Zusammenfassung der einzelnen Kapitel dar und stellt eine Verbindung der Ergebnisse aller Kapitel her. Zu Beginn dieser Arbeit zunächst in Kapitel \ref{chapter:association} die Optimierung einer fertigen TSDF-Karte mit initialer Pose-Historie algorithmisch analysiert. Dazu wurde untersucht, inwiefern Assoziationen zwischen dem initialen Pose-Graphen und der gegebenen TSDF-Karte hergestellt werden können. Dazu wurde im ersten Schritt herausgestellt, dass anhand der TSDF-Karte ohne zusätzliche Informationen keine gute Assoziationsbestimmung möglich ist. Wird die Karte zusätzlich für jede Zelle um eine Historie erweitert, die aufzeigt, von welchen Posen ausgehend die entsprechende Zelle beschrieben wird, relativiert sich dieses Problem. Dies sorgt wie herausgestellt allerdings für eine starke Vergrößerung des für die Karte benötigten Speichers. Zusätzlich stellt dies Probleme für die HDF5-Datenstruktur dar. Aus diesem Grund wurde die Ermittlung von Assoziationen mittels eines Raytracers untersucht, der ausgehend von den einzelnen Posen Strahlen aussendet und mit dem TSDF schneidet und entsprechend geschnittene Zellen mit der Pose assoziiert. Diese Bestimmung der Assoziationen funktioniert im Grundsatz, eröffnet allerdings weitere Probleme wie Karten-Bereiche die durch Verdeckungen nicht assoziiert werden können. Dazu gehören unter anderem die Teile der Karte, die durch die Optimierung aus der Karte herausgelöscht werden sollen, wie zum Beispiel doppelte Wände. Dadurch prägte sich heraus, dass der gewählte Prozess von großen Unsicherheiten geprägt ist. Dies verstärkte sich zusätzlich durch Probleme bei der Identifikation von Schleifenschlüssen, da die Datenbasis, auf Basis der Schleifenschlüsse identifiziert und validiert werden, hier die TSDF-Karte, zum Zeitpunkt der Identifikation bereits fehlerhaft ist. Dies sorgt implizit für fehlerhafte Schleifenschlüsse. Aus diesen Grund wurde der zunächst gewählte Ansatz verworfen und stattdessen auf einer größeren Datenbasis gearbeitet, die eine initiale Pose-Schätzung und die zugehörigen Punktwolken erhält. Ziel die Implementation und Konzeption eines Ansatzes, der in ein SLAM Verfahren wie den Ansatz von Eisoldt et al. \cite{HATSDF} integriert werden kann und zur Laufzeit die zur Registrierung neuer Daten genutzt TSDF-Karte auf Basis identifizierter Schleifenschlüsse zu optimieren. 

Um dieses Ziel zu erreichen wurde zunächst in Kapitel \ref{chapter:loop_closure} die Detektion von Schleifenschlüssen und die Optimierung des Pose-Graphen basierend auf der neuen Datenbasis behandelt. Dazu wird mittels eines \emph{k-d Baumes}, der die 3-D Position jeder Pose des Pose-Graphen enthält, für die aktuell betrachtete Pose eine \emph{Radius-Suche} mit einem parametrisierten Radius durchgeführt. Dies liefert eine Reihe von Kandidaten, die über ein \emph{Scan-Matching} zwischen den Punktwolken der beiden beteiligten Posen validiert werden. Dies liefert bereits gute Ergebnisse, jedoch ist die Anzahl so detektierter Schleifenschlüsse gering. Zur Verbesserung wurde auf der Annahme lokaler Konsistenz ein Fenster eingeführt, welches die (Model-)Punktwolke der Kandidaten-Pose mit den Punktwolken der umgebenden Posen anreichert beziehungsweise verbindet. Dies sorgt für eine deutlich dichtere Model-Punktwolke und damit verbunden für eine bessere Konvergenz des Scan-Matching und eine größere Anzahl validierter Schleifenschlüsse. Trotz der bereits vorgenommenen Validierung wurden Sonderfälle identifiziert, bei denen fehlerhafte Schleifenschlüsse validiert wurden. Dies tritt besonders in Umgebungen auf, in denen vergleichsweise wenig Features vorhanden sind, wie zum Beispiel in Fluren. Aus diesen Grund wurden zwei weitere Validatoren implementiert, die eine zusätzliche Beschränkung für Schleifenschlüsse darstellen. Sie stellen sicher, dass die Schleifenschlüsse sich innerhalb eines statischen Rahmens, gegeben durch die Unsicherheiten des Faktor-Graphen bewegen, der für die Optimierung des Pose-Graphen verwendet wird. Hier wird die Implementation des Faktor-Graphen von GTSAM \ref{dellaert2012factor} mitsamt der zugehörigen Optimierungsfunktionen verwendete. Dies sorgt für eine Optimierung des Pose-Graphen anhand von Schleifenschlüssen, die sowohl die Validierung durch das Scan-Matching, als auch die beiden weiteren vorgestellten Validierungsstufen durchlaufen haben. Insgesamt liefert der Ansatz sehr gute und mit anderen Herangehensweisen an dieses Optimierungsproblem wie zum Beispiel ELCH \cite{sprickerhof2011heuristic} vergleichbare Ergebnisse. 

Basierend auf diesen Ergebnissen der Pose-Graph Optimierung wurde in Kapitel \ref{chapter:map_update} die Optimierung der TSDF-Karte erneut beleuchtet. Dazu wurden zwei Möglichkeiten des Kartenupdates erläutert und miteinander verglichen. Das globale Update löscht die gesamte Karte nach Identifikation eines oder mehrerer Schleifenschlüsse und der resultierenden Anpassung des Pose-Graph. Nachdem die Karte gelöscht ist, wird sie vollständig neu generiert, indem inkrementelle TSDF-Updates basierend auf den neuen Posen und zugehörigen Punktwolken durchgeführt werden. Dieses globale Update ist allerdings sehr zeitintensiv und es werden jeweils Teile der Karte gelöscht, die keiner Löschung bedürfen, weil die mit den Teilbereichen assoziierten Posen nicht, oder nur minimal verschoben wurden. Aus diesem Grund wurde ein partielles Update entwickelt, welches nur die betroffenen Teilbereiche löscht. Zum Vergleich dient das globale Update als Base-Line. Um das partielle Update zu realisieren wurde zunächst das Tupel jeder TSDF-Zelle um ein weiteres Feld erweitert, welches den Index der Pose enthält, die zuletzt in diese Zelle geschrieben hat. Basierend auf dieser neuen Karten-Struktur wurden zwei Methoden vorgestellt, das Update durchzuführen. Dazu wurde die Teilmenge der Posen des Pose-Graphen bestimmt, deren Veränderung durch die Optimierung des Pose-Graphen größer ist als eine definierte Schwelle. Daraufhin werden alle Zellen, deren Pose-Index in der bestimmten Teilmenge der Posen enthalten ist, mit Default-Werten überschrieben. Hierfür wurden zwei Methoden entwickelt, wobei performantere Methode die Abstraktion der lokalen Karte umgeht und lediglich die Strukturen der globalen Karte verwendete. Im Anschluss wird die Karte per inkrementellem Update neu gefüllt. Dies sorgt für eine deutliche Reduktion der Laufzeit des Algorithmus. Im Falle vom Hannover-1 Datensatz benötigt das partielle Update nur $15\%$ der Laufzeit des globalen Updates. Dabei ist eine leichte Verringerung der Genauigkeit zu beobachten, die allerdings im Schnitt nicht größer ist als die Auflösung der lokalen Karte, die der begrenzende Faktor für die Genauigkeit des Ergebnisses ist.

Zusammenfassend lässt sich sagen, dass der vorgestellte Ansatz zur Optimierung des Pose-Graphen in Kombination mit dem partiellen Update der TSDF-Karte gute Ergebnisse liefert und die initiale Schätzungen -- und damit verbunden auch die Karte -- deutlich verbessert. Bezogen auf die Laufzeit ist an dieser Stelle allerdings noch viel Optimierungspotential und der Ansatz nicht näherungsweise Echtzeit fähig. Zusätzlich ist die verwendete Kartenstruktur mitsamt der Kapselung über die lokale Karte nicht optimal für den vorgestellten Ansatz, da eine Vielzahl von Operationen durchgeführt werden muss, die sehr zeitintensiv sind. Im Folgenden Abschnitt wird ein Ausblick über Themen gegeben, die nicht in den zeitlichen oder thematischen Rahmen gepasst haben, aber für zukünftige Forschungen in diesem Bereich von Interesse sein könnten.

\section{Ausblick}

In dieser Arbeit wurde bereits versucht Teaser++ zur Verbesserung des Scan-Matchings zu verwenden. Bei der Integration wurde allerdings ein Fehler in der von Teaser++ zur Verfügung gestellten API festgestellt. Augrund dieses Fehlers wurde am GitHub-Repository der Bibliothek ein Bug-Ticket erstellt und die Integration der Bibliothek vorerst hinten an gestellt. Vor Kurzem gab es nun Aktivität am erstellten Ticket und der Fehler scheint behoben. In einer zukünftigen Arbeit lohnt es sich gegebenenfalls, an dieser Stelle anzusetzen und Teaser++ zu integrieren.

Eingehen auf Bottleneck: Map-Shift -> großes Verbesserungspotential durch Parallelisierung
Eingehen auf TSDF-Update und Reverse Tsdf update (ebenfalls große Verbesserung erwartet).
Eingehen auf mögliche Lösung für zukünftige Arbeiten basierend auf der im Map-Update herausgestellten Erweiterung des Tupels - ggf. eine Möglichkeit für die Nachbearbeitung

Schreiben über Path-(Re-)Exploration, Beispiel anführen

Schreiben über Path-Exploration + Beispiel

\subsection{Optimierungen}

schreiben über laufzeittechnische Optimierungen, wie möglich?
tsdf-update, map-shift, oder gänzlich andere Kartenrepräsentation, die eine Vereinfachung der handhabung lokaler Daten ermöglicht, Evaluation von Map-Shifts erst dann, wenn gewisse Distanz bewegt, ...

Wichtig: Optimierung
